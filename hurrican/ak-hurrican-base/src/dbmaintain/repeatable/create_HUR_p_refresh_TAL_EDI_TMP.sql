CREATE OR REPLACE PROCEDURE P_HUR_refresh_TAL_EDI_TMP
AS
BEGIN
   DECLARE
      vsql   VARCHAR2 (4000);
   BEGIN
      ---------------------------------------------------------------------

      EXECUTE IMMEDIATE ('truncate table T_EDI_KUP_TMP');

      vsql :=
         '
INSERT INTO T_EDI_KUP_TMP (EDT_ID,
                             EDF_MONAT,
                             EDF_RECHNUNGSDATUM,
                             EDF_BETRAG_MOA9,
                             EDF_BETRAG_MOA77,
                             EDF_BETRAG_MOA79,
                             EDF_BETRAG_MOA124,
                             EDF_BETRAG_MOA125,
                             EDF_NAME,
                             EDF_TEXT1,
                             EDF_TEXT2,
                             T_DTAG_RECHNUNG_RECH_ID,
                             EDF_ABRECHNUNG_ART,
                             EDF_DATEITYP,
                             EDF_ABRECHNUNG_BIS,
                             EDT_EDF_ID,
                             EDT_EDA_ID,
                             EDT_ETA_ID,
                             EDT_ETY_ID,
                             EDT_EAL_ID,
                             EAL_NR_ELFE,
                             EDT_VON,
                             EDT_BIS,
                             EDT_ANZ,
                             EDT_BETRAG_POS,
                             EDT_BETRAG,
                             LBZ_COMP,
                             EDT_LEITUNGSNR,
                             EDT_VERTRAGSNR,
                             EDT_REFERENZ,
                             EDT_NAME,
                             EDT_TEXT1,
                             EDT_TEXT2,
                             EDT_LEITUNGSNR_ORI,
                             EDT_ENDSTELLE_A,
                             EDT_ENDSTELLE_B,
                             EDT_EXTERNE_AUFTRAGSNUMMER,
                             EDT_STOERUNGSNUMMER,
                             EDT_STOERUNGSDATUM,
                             EDT_GUTSCHRIFT_VERTRAGSNUMMER,
                             EDT_MATERIALNUMMER,
                             EDT_KONDITIONSID,
                             EDT_VERTRAGSNUMMER,
                             T_DTAG_TAL_RECH_ID,
                             T_DTAG_TAL_ID,
                             EAL_KONDITIONS_ID,
                             EAL_ID,
                             EAL_NR,
                             EAL_RECHNUNGSTEXT,
                             EAL_TEXT,
                             LBZ_ONKZ)
   (SELECT EDT_ID,
           EDF_MONAT,
           EDF_RECHNUNGSDATUM,
           EDF_BETRAG_MOA9,
           EDF_BETRAG_MOA77,
           EDF_BETRAG_MOA79,
           EDF_BETRAG_MOA124,
           EDF_BETRAG_MOA125,
           EDF_NAME,
           EDF_TEXT1,
           EDF_TEXT2,
           T_DTAG_RECHNUNG_RECH_ID,
           EDF_ABRECHNUNG_ART,
           EDF_DATEITYP,
           EDF_ABRECHNUNG_BIS,
           EDT_EDF_ID,
           EDT_EDA_ID,
           EDT_ETA_ID,
           EDT_ETY_ID,
           EDT_EAL_ID,
           EAL_NR_ELFE,
           EDT_VON,
           EDT_BIS,
           EDT_ANZ,
           EDT_BETRAG_POS,
           EDT_BETRAG,
           LBZ_COMP,
           EDT_LEITUNGSNR,
           EDT_VERTRAGSNR,
           EDT_REFERENZ,
           EDT_NAME,
           EDT_TEXT1,
           EDT_TEXT2,
           EDT_LEITUNGSNR_ORI,
           EDT_ENDSTELLE_A,
           EDT_ENDSTELLE_B,
           EDT_EXTERNE_AUFTRAGSNUMMER,
           EDT_STOERUNGSNUMMER,
           EDT_STOERUNGSDATUM,
           EDT_GUTSCHRIFT_VERTRAGSNUMMER,
           EDT_MATERIALNUMMER,
           EDT_KONDITIONSID,
           EDT_VERTRAGSNUMMER,
           T_DTAG_TAL_RECH_ID,
           T_DTAG_TAL_ID,
           EAL_KONDITIONS_ID,
           EAL_ID,
           EAL_NR,
           EAL_RECHNUNGSTEXT,
           EAL_TEXT,
           LBZ_ONKZ
    FROM mnetcall.VHUR_TAL_DATEN_AKTUELL@kupvis)
    ';
      EXECUTE IMMEDIATE (vsql);
   END;
END p_HUR_refresh_TAL_EDI_TMP;
/
